$(document).ready(function(){$("#TithiDate").datepicker({dateFormat:"dd MM yy"}).datepicker("setDate",new Date());$("#vaarDate").datepicker({dateFormat:"dd MM yy"}).datepicker("setDate",new Date());$("#MuhuratDate").datepicker({dateFormat:"dd MM yy"}).datepicker("setDate",new Date());$("#RahukaalDate").datepicker({dateFormat:"dd MM yy"}).datepicker("setDate",new Date());$("#KaranaDate").datepicker({dateFormat:"dd MM yy"}).datepicker("setDate",new Date());$("#YogDate").datepicker({dateFormat:"dd MM yy"}).datepicker("setDate",new Date());var data2=localStorage.getItem('panchangdata');var data=localStorage.getItem('geoLocationData');var currentdate=new Date();currentdate=currentdate.getDate();var _geoLocation=JSON.parse(localStorage.getItem('geoLocationData'));if(data2==null||data==null){$.ajax({type:'get',url:'/ContentSyn/panchang/GetGeoLocation',success:function(response){if(response.data){_geoLocationdata=response.data;console.log(response.ipAddress);var _geoLocationdata1=JSON.stringify(_geoLocationdata);localStorage.setItem('geoLocationData',_geoLocationdata1);$.ajax({type:'get',url:'/ContentSyn/kundli/GetTithiDetails',dataType:'json',data:{objStr:JSON.stringify(_geoLocationdata)},success:function(result){if(result.data){_panchangdata=result.data;var _panchangdata1=JSON.stringify(_panchangdata);localStorage.setItem('panchangdata',_panchangdata1);var _panchangdata=JSON.parse(localStorage.getItem('panchangdata'));var _geoLocationdata=JSON.parse(localStorage.getItem('geoLocationData'));var purnimanta=_panchangdata.tithi.details.tithi_name+" upto "+_panchangdata.tithi.end_time.hour+":"+_panchangdata.tithi.end_time.minute+":"+_panchangdata.tithi.end_time.second+", "+_panchangdata.hindu_maah.purnimanta+", Vikram Samvat -"+_panchangdata.vikram_samvat;var amanta=_panchangdata.tithi.details.tithi_name+" upto "+_panchangdata.tithi.end_time.hour+":"+_panchangdata.tithi.end_time.minute+":"+_panchangdata.tithi.end_time.second+", "+_panchangdata.hindu_maah.amanta+", Shaka Samvat -"+_panchangdata.shaka_samvat;$("#purnimantadata").text(purnimanta);$("#amantadata").text(amanta);$("#cityName").text(_geoLocationdata.city);$("#vaar").text(_panchangdata.day);$("#muhuratdata").text(_panchangdata.abhijit_muhurta.start+" to "+_panchangdata.abhijit_muhurta.end);$("#yogdata").text(_panchangdata.yog.details.yog_name+" till "+_panchangdata.yog.end_time.hour+":"+_panchangdata.yog.end_time.minute+":"+_panchangdata.yog.end_time.second);$("#karanadata").text(_panchangdata.karan.details.karan_name+" till "+_panchangdata.karan.end_time.hour+":"+_panchangdata.karan.end_time.minute+":"+_panchangdata.karan.end_time.second);$("#rahukaaldata").text(_panchangdata.rahukaal.start+" to "+_panchangdata.rahukaal.end);}}});}}});}
else if(currentdate!=_geoLocation.day){localStorage.removeItem("panchangdata");localStorage.removeItem("geoLocationData");var data2=localStorage.getItem('panchangdata');var data=localStorage.getItem('geoLocationData');$.ajax({type:'get',url:'/ContentSyn/panchang/GetGeoLocation',success:function(response){if(response.data){_geoLocationdata=response.data;var _geoLocationdata1=JSON.stringify(_geoLocationdata);localStorage.setItem('geoLocationData',_geoLocationdata1);$.ajax({type:'get',url:'/ContentSyn/kundli/GetTithiDetails',dataType:'json',data:{objStr:JSON.stringify(_geoLocationdata)},success:function(result){if(result.data){_panchangdata=result.data;var _panchangdata1=JSON.stringify(_panchangdata);localStorage.setItem('panchangdata',_panchangdata1);var _panchangdata=JSON.parse(localStorage.getItem('panchangdata'));var _geoLocationdata=JSON.parse(localStorage.getItem('geoLocationData'));var purnimanta=_panchangdata.tithi.details.tithi_name+" upto "+_panchangdata.tithi.end_time.hour+":"+_panchangdata.tithi.end_time.minute+":"+_panchangdata.tithi.end_time.second+", "+_panchangdata.hindu_maah.purnimanta+", Vikram Samvat -"+_panchangdata.vikram_samvat;var amanta=_panchangdata.tithi.details.tithi_name+" upto "+_panchangdata.tithi.end_time.hour+":"+_panchangdata.tithi.end_time.minute+":"+_panchangdata.tithi.end_time.second+", "+_panchangdata.hindu_maah.amanta+", Shaka Samvat -"+_panchangdata.shaka_samvat;$("#purnimantadata").text(purnimanta);$("#amantadata").text(amanta);$("#cityName").text(_geoLocationdata.city);$("#vaar").text(_panchangdata.day);$("#muhuratdata").text(_panchangdata.abhijit_muhurta.start+" to "+_panchangdata.abhijit_muhurta.end);$("#yogdata").text(_panchangdata.yog.details.yog_name+" till "+_panchangdata.yog.end_time.hour+":"+_panchangdata.yog.end_time.minute+":"+_panchangdata.yog.end_time.second);$("#karanadata").text(_panchangdata.karan.details.karan_name+" till "+_panchangdata.karan.end_time.hour+":"+_panchangdata.karan.end_time.minute+":"+_panchangdata.karan.end_time.second);$("#rahukaaldata").text(_panchangdata.rahukaal.start+" to "+_panchangdata.rahukaal.end);}}});}}});}else{var _panchangdata=JSON.parse(localStorage.getItem('panchangdata'));var _geoLocationdata=JSON.parse(localStorage.getItem('geoLocationData'));var purnimanta=_panchangdata.tithi.details.tithi_name+" upto "+_panchangdata.tithi.end_time.hour+":"+_panchangdata.tithi.end_time.minute+":"+_panchangdata.tithi.end_time.second+", "+_panchangdata.hindu_maah.purnimanta+", Vikram Samvat -"+_panchangdata.vikram_samvat;var amanta=_panchangdata.tithi.details.tithi_name+" upto "+_panchangdata.tithi.end_time.hour+":"+_panchangdata.tithi.end_time.minute+":"+_panchangdata.tithi.end_time.second+", "+_panchangdata.hindu_maah.amanta+", Shaka Samvat -"+_panchangdata.shaka_samvat;$("#purnimantadata").text(purnimanta);$("#amantadata").text(amanta);$("#cityName").text(_geoLocationdata.city);$("#vaar").text(_panchangdata.day);$("#muhuratdata").text(_panchangdata.abhijit_muhurta.start+" to "+_panchangdata.abhijit_muhurta.end);$("#yogdata").text(_panchangdata.yog.details.yog_name+" till "+_panchangdata.yog.end_time.hour+":"+_panchangdata.yog.end_time.minute+":"+_panchangdata.yog.end_time.second);$("#karanadata").text(_panchangdata.karan.details.karan_name+" till "+_panchangdata.karan.end_time.hour+":"+_panchangdata.karan.end_time.minute+":"+_panchangdata.karan.end_time.second);$("#rahukaaldata").text(_panchangdata.rahukaal.start+" to "+_panchangdata.rahukaal.end);}});function showLocation(position){var latitude=position.coords.latitude;var longitude=position.coords.longitude;var latlongvalue=position.coords.latitude+","+
position.coords.longitude;var timestamp=position.coords.timestamp;if(latitude!=null&&longitude!=null&&timestamp!=null){$('#Latitude').val(latitude);$('#Longitude').val(longitude);$('#Timezone').val(timestamp);GetTithi();}
console.log(latitude,longitude);}
function errorHandler(err){if(err.code==1){alert("Error: Access is denied!");}else if(err.code==2){alert("Error: Position is unavailable!");}}
$(function(){$("#TithiDate").datepicker({changeMonth:true,changeYear:true,dateFormat:'dd MM yy'});$("#vaarDate").datepicker({changeMonth:true,changeYear:true,dateFormat:'dd MM yy'});$("#MuhuratDate").datepicker({changeMonth:true,changeYear:true,dateFormat:'dd MM yy'});$("#RahukaalDate").datepicker({changeMonth:true,changeYear:true,dateFormat:'dd MM yy'});$("#KaranaDate").datepicker({changeMonth:true,changeYear:true,dateFormat:'dd MM yy'});$("#YogDate").datepicker({changeMonth:true,changeYear:true,dateFormat:'dd MM yy'});});function showDate(date){alert('The date chosen is '+date);}
var googlihitcheck=0;var array=null;$('#PanchangPlace').keyup(function(){if($("#PanchangPlace").val().length>=1){$.ajax({type:"GET",url:"/staticdata/getgeolocationasync",data:{_searchText:$("#PanchangPlace").val()},success:function(result){if(result.success==true){array=result.data;var jsonString=JSON.parse(JSON.stringify(result.data));$('#PanchangPlace').autocomplete({source:$.map(jsonString,function(item){return item.location+","+item.state+","+item.countryCode;}),select:function(event,ui){var nameArr=ui.item.value.split(',');var details=array.filter(x=>x.location===nameArr[0]&&x.state===nameArr[1]&&x.countryCode===nameArr[2])[0];$("#Latitude").val(details.latitute);$("#Longitude").val(details.longitutde);$("#Timezone").val(details.timeZone);if(details.timeZone==null)
{n=details.latitute,i=details.longitutde;var d=new Date,u="https://maps.googleapis.com/maps/api/timezone/json?location="+n+","+i+"&timestamp="+(d.getTime()/1e3+60*d.getTimezoneOffset())+"&key=AIzaSyCFuOlkFwvEa9kplV3RP7wnbtQHmSvZMsQ",a=new XMLHttpRequest;a.open("GET",u),a.onload=function(){if(200===a.status){var e=JSON.parse(a.responseText);if("OK"==e.status){var t=(e.dstOffset+e.rawOffset)/3600;$("#Timezone").val(t)}}},a.send();}
$("#MandLocation").hide();$("#MandVaarLocation").hide();$("#MuhuratLocation").hide();$("#yogLocation").hide();$("#karanaLocation").hide();var selectecItem=jsonString.filter(function(value){$("#PanchangPlace").val(ui.item.value);});},});}
else
{$.getScript('https://maps.googleapis.com/maps/api/js?key=AIzaSyCWFvWQ9BYo6UBtX0hA8QxSv-wq1485ttE&libraries=places',function()
{googlihitcheck=1;initialize();});}},failure:function(e){$("#kundliRegistrationFrm").find("[type='submit']").removeAttr("disabled"),$("#kundliRegistrationFrm").find("[type='submit']").text(a)}})}});function initialize(){var e=new google.maps.places.Autocomplete(document.getElementById("PanchangPlace"),{types:["(cities)"]});google.maps.event.addListener(e,"place_changed",function(){$("#Latitude").val(""),$("#Longitude").val(""),$("#Timezone").val("");var t=e.getPlace(),n=t.geometry.location.lat(),i=t.geometry.location.lng();$("#Latitude").val(n),$("#Longitude").val(i);var d=new Date,u="https://maps.googleapis.com/maps/api/timezone/json?location="+n+","+i+"&timestamp="+(d.getTime()/1e3+60*d.getTimezoneOffset())+"&key=AIzaSyCFuOlkFwvEa9kplV3RP7wnbtQHmSvZMsQ",a=new XMLHttpRequest;a.open("GET",u),a.onload=function(){if(200===a.status){var e=JSON.parse(a.responseText);if("OK"==e.status){var t=(e.dstOffset+e.rawOffset)/3600;$("#Timezone").val(t)}}},a.send()})}
function GetTithi(){var data={};if($("#PanchangPlace").val()=="undefined"||$("#PanchangPlace").val()==""){$("#MandLocation").text("Please Select Location");return false;}
if($('#Latitude').val()==""&&$('#Longitude').val()==""&&$('#Timezone').val()=="")
{$("#MandLocation").text("");$("#MandLocation").text("Select Valid location");return false;}
var cityname=$("#PanchangPlace").val();var date2=$('#TithiDate').val();if(date2==""){var date=new Date();data.Day=date.getDate();data.Month=date.getMonth()+1;data.Year=date.getFullYear();}else{var date=new Date(date2);console.log(date);data.Day=date.getDate();data.Month=date.getMonth()+1;data.Year=date.getFullYear();}
var dt=new Date();data.Hour=dt.getHours();data.Min=dt.getMinutes();data.Lat=$('#Latitude').val();data.Lon=$('#Longitude').val();data.Tzone=$('#Timezone').val();InputData=data;$.ajax({type:'get',url:'/ContentSyn/kundli/GetTithiDetails',dataType:'json',data:{objStr:JSON.stringify(data)},success:function(response){if(response.data){console.log(response.data);var purnimanta=response.data.tithi.details.tithi_name+" upto "+response.data.tithi.end_time.hour+":"+response.data.tithi.end_time.minute+":"+response.data.tithi.end_time.second+", "+response.data.hindu_maah.purnimanta+", Vikram Samvat -"+response.data.vikram_samvat;var amanta=response.data.tithi.details.tithi_name+" upto "+response.data.tithi.end_time.hour+":"+response.data.tithi.end_time.minute+":"+response.data.tithi.end_time.second+", "+response.data.hindu_maah.amanta+", Shaka Samvat -"+response.data.shaka_samvat;$("#purnimantadata").text(purnimanta);$("#amantadata").text(amanta);$("#cityName").text(cityname);if(date2!=""){var dateVar=date2;var dsplit=dateVar.split("/");var d=new Date(dsplit[0],dsplit[1]-1,dsplit[2]);$("#tithitoday").text(dateVar);}else{$("#tithitoday").text(date.toDateString());}}}});}
function GetVaar(){var data={};if($("#PanchangPlace").val()==""){$("#MandVaarLocation").text("Please Select Location");return false;}
if($('#Latitude').val()==""&&$('#Longitude').val()==""&&$('#Timezone').val()=="")
{$("#MandVaarLocation").text("");$("#MandVaarLocation").text("Select Valid location");return false;}
var cityname=$("#PanchangPlace").val();var date2=$("#vaarDate").val();if(date2==""){var date=new Date();data.Day=date.getDate();data.Month=date.getMonth()+1;data.Year=date.getFullYear();}else{var date=new Date(date2);console.log(date);data.Day=date.getDate();data.Month=date.getMonth()+1;data.Year=date.getFullYear();}
var dt=new Date();data.Hour=dt.getHours();data.Min=dt.getMinutes();data.Lat=$('#Latitude').val();data.Lon=$('#Longitude').val();data.Tzone=$('#Timezone').val();InputData=data;$.ajax({type:'get',url:'/ContentSyn/kundli/GetTithiDetails',dataType:'json',data:{objStr:JSON.stringify(data)},success:function(response){if(response.data){$("#vaar").text(response.data.day);$("#cityName").text(cityname);if(date2!=""){var dateVar=date2;var dsplit=dateVar.split("/");var d=new Date(dsplit[0],dsplit[1]-1,dsplit[2]);$("#vaartoday").text(dateVar);}else{$("#vaartoday").text(date.toDateString());}}}});}
function GetMuhurat(){var data={};if($("#PanchangPlace").val()==""){$("#MuhuratLocation").text("Please Select Location");return false;}
if($('#Latitude').val()==""&&$('#Longitude').val()==""&&$('#Timezone').val()=="")
{$("#MuhuratLocation").text("");$("#MuhuratLocation").text("Select Valid location");return false;}
var cityname=$("#PanchangPlace").val();var date2=$('#MuhuratDate').val();if(date2==""){var date=new Date();data.Day=date.getDate();data.Month=date.getMonth()+1;data.Year=date.getFullYear();}else{var date=new Date(date2);console.log(date);data.Day=date.getDate();data.Month=date.getMonth()+1;data.Year=date.getFullYear();}
var dt=new Date();data.Hour=dt.getHours();data.Min=dt.getMinutes();data.Lat=$('#Latitude').val();data.Lon=$('#Longitude').val();data.Tzone=$('#Timezone').val();InputData=data;$.ajax({type:'get',url:'/ContentSyn/kundli/GetTithiDetails',dataType:'json',data:{objStr:JSON.stringify(data)},success:function(response){if(response.data){$("#muhuratdata").text(response.data.abhijit_muhurta.start+" to "+response.data.abhijit_muhurta.end);$("#cityName").text(cityname);if(date2!=""){var dateVar=date2;var dsplit=dateVar.split("/");var d=new Date(dsplit[0],dsplit[1]-1,dsplit[2]);$("#muhurattoday").text(dateVar);}else{$("#muhurattoday").text(date.toDateString());}}}});}
function GetRahuKaal(){var data={};if($("#PanchangPlace").val()==""){$("#rahukalLocation").text("Please Select Location");return false;}
if($('#Latitude').val()==""&&$('#Longitude').val()==""&&$('#Timezone').val()=="")
{$("#rahukalLocation").text("");$("#rahukalLocation").text("Select Valid location");return false;}
var cityname=$("#PanchangPlace").val();var date2=$('#RahukaalDate').val();if(date2==""){var date=new Date();data.Day=date.getDate();data.Month=date.getMonth()+1;data.Year=date.getFullYear();}else{var date=new Date(date2);console.log(date);data.Day=date.getDate();data.Month=date.getMonth()+1;data.Year=date.getFullYear();}
var dt=new Date();data.Hour=dt.getHours();data.Min=dt.getMinutes();data.Lat=$('#Latitude').val();data.Lon=$('#Longitude').val();data.Tzone=$('#Timezone').val();InputData=data;$.ajax({type:'get',url:'/ContentSyn/kundli/GetTithiDetails',dataType:'json',data:{objStr:JSON.stringify(data)},success:function(response){if(response.data){$("#rahukaaldata").text(response.data.rahukaal.start+" to "+response.data.rahukaal.end);$("#cityName").text(cityname);if(date2!=""){var dateVar=date2;var dsplit=dateVar.split("/");var d=new Date(dsplit[0],dsplit[1]-1,dsplit[2]);$("#rahukaltoday").text(dateVar);}else{$("#rahukaltoday").text(date.toDateString());}}}});}
function GetYog(){var data={};if($("#PanchangPlace").val()==""){$("#yogLocation").text("Please Select Location");return false;}
if($('#Latitude').val()==""&&$('#Longitude').val()==""&&$('#Timezone').val()=="")
{$("#yogLocation").text("");$("#yogLocation").text("Select Valid location");return false;}
var cityname=$("#PanchangPlace").val();var date2=$('#YogDate').val();if(date2==""){var date=new Date();data.Day=date.getDate();data.Month=date.getMonth()+1;data.Year=date.getFullYear();}else{var date=new Date(date2);console.log(date);data.Day=date.getDate();data.Month=date.getMonth()+1;data.Year=date.getFullYear();}
var dt=new Date();data.Hour=dt.getHours();data.Min=dt.getMinutes();data.Lat=$('#Latitude').val();data.Lon=$('#Longitude').val();data.Tzone=$('#Timezone').val();InputData=data;$.ajax({type:'get',url:'/ContentSyn/kundli/GetTithiDetails',dataType:'json',data:{objStr:JSON.stringify(data)},success:function(response){if(response.data){$("#yogdata").text(response.data.yog.details.yog_name+" till "+response.data.yog.end_time.hour+":"+response.data.yog.end_time.minute+":"+response.data.yog.end_time.second);$("#cityName").text(cityname);if(date2!=""){var dateVar=date2;var dsplit=dateVar.split("/");var d=new Date(dsplit[0],dsplit[1]-1,dsplit[2]);$("#yogtoday").text(dateVar);}else{$("#yogtoday").text(date.toDateString());}}}});}
function GetKarana(){var data={};if($("#PanchangPlace").val()==""){$("#karanaLocation").text("Please Select Location");return false;}
if($('#Latitude').val()==""&&$('#Longitude').val()==""&&$('#Timezone').val()=="")
{$("#karanaLocation").text("");$("#karanaLocation").text("Select Valid location");return false;}
var cityname=$("#PanchangPlace").val();var date2=$('#KaranaDate').val();if(date2==""){var date=new Date();data.Day=date.getDate();data.Month=date.getMonth()+1;data.Year=date.getFullYear();}else{var date=new Date(date2);console.log(date);data.Day=date.getDate();data.Month=date.getMonth()+1;data.Year=date.getFullYear();}
var dt=new Date();data.Hour=dt.getHours();data.Min=dt.getMinutes();data.Lat=$('#Latitude').val();data.Lon=$('#Longitude').val();data.Tzone=$('#Timezone').val();InputData=data;$.ajax({type:'get',url:'/ContentSyn/kundli/GetTithiDetails',dataType:'json',data:{objStr:JSON.stringify(data)},success:function(response){if(response.data){$("#karanadata").text(response.data.karan.details.karan_name+" till "+response.data.karan.end_time.hour+":"+response.data.karan.end_time.minute+":"+response.data.karan.end_time.second);$("#cityName").text(cityname);if(date2!=""){var dateVar=date2;var dsplit=dateVar.split("/");var d=new Date(dsplit[0],dsplit[1]-1,dsplit[2]);$("#karanatoday").text(dateVar);}else{$("#karanatoday").text(date.toDateString());}}}});}